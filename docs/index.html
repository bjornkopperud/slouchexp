<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stochastic Linear Ornstein-Uhlenbeck Comparative Hypotheses • slouch</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">slouch</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/kopperud/slouch">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    

<div id="install-and-load-devtools" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#install-and-load-devtools" class="anchor"></a>Install and load devtools</h1></div>
<p>Devtools makes it much easier to install R packages straight from github</p>
<pre><code>install.packages("devtools")
library(devtools)</code></pre>
</div>
<div id="install-and-load-slouch" class="section level1">
<h1 class="hasAnchor">
<a href="#install-and-load-slouch" class="anchor"></a>Install and load slouch</h1>
<pre><code>devtools::install_github("kopperud/slouch")
library(slouch)</code></pre>
</div>
<div id="documentation" class="section level1">
<h1 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h1>
<p>There is a <strong>vignette</strong> written as a short introduction to the syntax of the main functions in this package. The vignette can be viewed either in R along with the regular R documentation by typing the command <code><a href="reference/slouch-package.html">?slouch</a></code>, or at <a href="https://kopperud.github.io/slouch/articles/user-guide.html">the package website</a>.</p>
</div>
<div id="notable-changes-since-v2-" class="section level1">
<h1 class="hasAnchor">
<a href="#notable-changes-since-v2-" class="anchor"></a>Notable changes since v2.*</h1>
<div id="bugfixes" class="section level3">
<h3 class="hasAnchor">
<a href="#bugfixes" class="anchor"></a>Bugfixes:</h3>
<ul>
<li>Regression coefficients now correctly start with an OLS estimate instead of using the GLS-estimate for the previous iteration in the gridsearch, for categorical models</li>
<li>For categorical models: Seeding OLS regression is now correctly done for every iteration in grid search, for every model matrix X, instead of an invariate model matrix X whose alpha is arbitrary (e.g a = 10)</li>
<li>Most if not all model combinations should now support multiple continuous covariates, e.g fixed.cov = cbind(X, Z, …), without crashing before returning model outputs.</li>
<li>Vectorize the code calculating residual var-cov matrix for models with brownian covariates, thus fixing one index typo. Bug was only relevant for non-ultrametric trees.</li>
<li>Fix incorrect calculation of branch lengths “tja” and “tia” for non-ultrametric trees, see below for new tree format</li>
<li>The weight matrix generated with categorical covariates is no longer sorted by columns, the order is now invariant with respect to alpha. This was not strictly a bug but if the coefficient labels are not rearranged in the same way, output will be wrong &amp; misleading.</li>
</ul>
</div>
<div id="structural-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#structural-changes" class="anchor"></a>Structural changes</h3>
<ul>
<li>Code duplication largely removed, R-code reduced from about 4k to 1k lines.</li>
<li>SLOUCH now uses Git version control.</li>
<li>Direct effect models now about 4x faster. Models with categorical and/or brownian covariates are now estimated nearly as fast as direct effect models.</li>
<li>Grid-search now has support for using multiple CPU cores, currently only for windows.</li>
<li>A hillclimber routine (L-BFGS) implemented in R base <code>optim()</code> is implemented. This routine can be used standalone or combined with the hillclimber, where the hillclimber starts at the best ML-estimate from the grid-search.</li>
<li>The format used to display trees in OUCH/SLOUCH is now scrapped in favor of package <code>ape</code>. Calculation of branch lengths is now dependent on this package, and the weight matrix functions have been rewritten from scratch to accomodate the new format. SLOUCH is now technically no longer an extension of OUCH.</li>
<li>Inner “workhorse” loop of the weight matrix functions is rewritten in C++</li>
<li>Because of this, functions for simulating OU traits, plotting the tree, and the Fitch algorithm for reconstructing ancestral states have been scrapped.</li>
<li>SLOUCH now depends on packages <code>parallel</code>, <code>ape</code>, <code>Rcpp</code>.</li>
<li>Model outputs are no longer printed directly in the console, but returned as a composite object of class <code>slouch</code>, essentially a list with lots of information and methods for printing and plotting.</li>
<li>Arguments <code>intercept</code> and <code>ultrametric</code> are misleading. Changed to <code>estimate.Ya</code> and <code>estimate.bXa</code>, see docstrings.</li>
<li>SLOUCH now has one unit test, should be many more</li>
</ul>
</div>
<div id="other-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#other-changes" class="anchor"></a>Other changes</h3>
<ul>
<li>For grid-search, the marginal support set for alpha and sigma are now calculated and given in a table.</li>
<li>The GLS estimator is now not used as-is to calculate regression coefficients. Instead, the lower triangular matrix of the cholesky factorization of $V = C^TC$, $L = C^T$ is used to “transform” $X_{<em>} = L^{-1}X$ and $Y_{</em>} = L^{-1}Y$. Next, $X_<em>$ and $Y_</em>$ are fed to R’s <code>lm.fit()</code>, which uses QR-decomposition to calculate coefficients. This makes for about a 4x speedup. Also if X is singular, the program will now not crash but return “NA” in the regression coefficients.</li>
<li>Calculation of $log(det(V))$ is now done differently, both to increase speed and numerical stability (not returning <code>Inf</code>) when N is large.</li>
<li>Docstrings are now available, though crude.</li>
</ul>
</div>
</div>

  </div>

  <div class="col-md-3" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="http://github.com/kopperud/slouch">http://​github.com/​kopperud/​slouch</a>
</li>
<li>Report a bug at <br><a href="http://github.com/kopperud/slouch/issues">http://​github.com/​kopperud/​slouch/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>What license is it under?</p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Bjørn Tore Kopperud <br><small class="roles"> Author, maintainer </small> </li>
<li>Jason Pienaar <br><small class="roles"> Author </small> </li>
<li>Kjetil Lysne Voje <br><small class="roles"> Author </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/kopperud/slouch"><img src="https://travis-ci.org/kopperud/slouch.svg?branch=master" alt="Build Status"></a></li>
</ul>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Bjørn Tore Kopperud, Jason Pienaar, Kjetil Lysne Voje.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
